<!DOCTYPE html>
<html lang="en">
<head>

    <!-- Use below if downloaded plotly -->
    <!-- <script src="plotly-2.4.2.min.js"></script> -->
    <script src="https://cdn.plot.ly/plotly-2.4.2.min.js"></script>
    <script src="https://unpkg.com/mathjs@9.5.0/lib/browser/math.js"></script>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

</head>
<body>
    
    <form id="form">
        <label for="function">Enter f(x): <input type="text" name="function" id="function" value="x^2"></label>
        <label for="upper">Upper limit: <input type="text" name="upper" id="upper" value="1"></label>
        <label for="lower">Lower limit: <input type="text" name="lower" id="lower" value="0"></label>
        <label for="n">Number of Trapezoids (4-10): <input type="text" name="n" id="n" min="4" max="10" value="4"></label>
        <input type="submit" value="Draw">
    </form>

    <div id="plot">
    </div>

    <script>
        function plotGraph() {
            try {
                // Compiling f(x) into readable equation
                const fx = document.getElementById('function').value;                
                const eq = math.compile(fx);

                //Evaluate f(x) for different plot points of x & y
                const xVal = math.range(-10, 10, 0.1).toArray();
                const yVal = xVal.map(function (x) {
                    return eq.evaluate({x: x})
                })

                //Render plot for f(x) graph
                const trace = {
                    x: xVal,
                    y: yVal,
                    type: 'line'
                }
                
                Plotly.newPlot('plot', [trace]);

                // Upper, Lower, n
                const upper = document.getElementById('upper').value;
                const lower = document.getElementById('lower').value;
                const n = document.getElementById('n').value;

                //Calculate h
                const h = (upper-lower)/n;

                //Compute sum of first and last terms of equation
                //Do this because middle terms will all be multiplied by 2
                const sum = eq.evaluate({x: upper}) + eq.evaluate({x: lower});

                //Compute middle terms
                for (i = 1; i < n; i++) {
                    const scope = lower+i*h;
                    sum += 2*eq.evaluate({x: scope});
                }

                const tArea = (h/2)*sum;
            }
            catch (err) {
                console.error(err);
                alert(err);
            }            
        }

        document.getElementById('form').onsubmit = function(event) {
            event.preventDefault();
            plotGraph();
        }
    </script>

</body>
</html>